<h1 id="programsAnchor" class="mt-4">{{ I18ns.programs.title }}</h1>
<p class="mb-4">{{ I18ns.programs.subtitle }}</p>
<div class="pb-4 border-bottom">
  <alto-anchor-navigator fragment="programsAnchor">
    <button type="button" class="btn btn-outline-secondary me-4">{{ I18ns.programs.programs.title }}</button>
  </alto-anchor-navigator>
  <alto-anchor-navigator fragment="questionsAnchor">
    <button type="button" class="btn btn-outline-secondary me-4">{{ I18ns.programs.questions.title }}</button>
  </alto-anchor-navigator>
  <alto-anchor-navigator fragment="submittedQuestionsAnchor">
    <button type="button" class="btn btn-outline-secondary me-4">
      {{ I18ns.programs.awaitQuestions.title }}
    </button>
  </alto-anchor-navigator>
  <alto-anchor-navigator fragment="tagsAnchor">
    <button type="button" class="btn btn-outline-secondary me-4">{{ I18ns.programs.tags.title }}</button>
  </alto-anchor-navigator>
</div>
<div class="py-4 border-bottom">
  <div>
    <a type="button" class="btn btn-primary float-end" [routerLink]="AltoRoutes.programsCreate">
      {{ I18ns.programs.programs.createProgram }}
    </a>
    <h1>{{ I18ns.programs.programs.title }}</h1>
    <p class="mb-4">{{ I18ns.programs.programs.subtitle }}</p>
  </div>
  <div class="text-end mb-4">
    <alto-dropdown-filter
      class="text-start"
      [data]="teamStore.teams.value"
      [displayLabel]="'shortName'"
      [placeholder]="I18ns.programs.programs.filters.team"
      (selectChange)="filterPrograms($event)"
      [isColored]="true"
    ></alto-dropdown-filter>

    <alto-search class="d-inline-block ms-3" (searchChange)="searchPrograms($event)"></alto-search>
  </div>
  <div class="row mb-3">
    <div class="col-4 mb-3" *ngFor="let prog of programs">
      <alto-program-card [displayToggle]="true" [program]="prog"></alto-program-card>
    </div>
  </div>
  <ngb-pagination
    [collectionSize]="programsCount"
    [(page)]="programsPage"
    (pageChange)="changeProgramPage()"
    [pageSize]="programPageSize"
    [maxSize]="10"
    aria-label="Default pagination"
  ></ngb-pagination>
</div>
<div class="py-4 border-bottom">
  <button type="button" class="btn btn-primary float-end" (click)="openQuestionForm()">
    {{ I18ns.programs.questions.createQuestion }}
  </button>
  <h1 id="questionsAnchor">{{ I18ns.programs.questions.title }}</h1>
  <p class="mb-4">{{ I18ns.programs.questions.subtitle }}</p>
  <div class="col-5 text-end mb-4 row">
    <alto-dropdown-filter
      class="text-start col-1"
      [data]="programsStore.programs.value"
      [displayLabel]="'name'"
      [placeholder]="I18ns.programs.questions.filters.programs"
      (selectChange)="filterQuestionsByPrograms($event)"
    ></alto-dropdown-filter>
    <alto-dropdown-filter
      class="text-start col-1"
      [data]="programsStore.tags.value"
      [displayLabel]="'name'"
      [placeholder]="I18ns.programs.questions.filters.tags"
      (selectChange)="filterQuestionsByTags($event)"
    ></alto-dropdown-filter>
    <alto-dropdown-filter
      class="text-start col-1"
      [data]="profileStore.users.value"
      [displayLabel]="'username'"
      [placeholder]="I18ns.programs.questions.filters.contributors"
      (selectChange)="filterQuestionsByContributors($event)"
    ></alto-dropdown-filter>
  </div>
  <table class="table">
    <thead>
      <tr>
        <th scope="col">{{ I18ns.programs.questions.table.question }}</th>
        <th scope="col">{{ I18ns.programs.questions.table.score }}</th>
        <th scope="col">{{ I18ns.programs.questions.table.author }}</th>
        <th scope="col">{{ I18ns.programs.questions.table.tags }}</th>
        <th scope="col">{{ I18ns.programs.questions.table.programs }}</th>
        <th></th>
      </tr>
    </thead>
    <tbody *ngIf="!isQuestionsLoading">
      <tr *ngFor="let question of questions">
        <th scope="row" class="col-3">
          {{ question.title }}
        </th>
        <td>
          <span class="badge rounded-pill" [class]="72 | pillColor">{{
            getQuestionScore(question.id) | percent
          }}</span>
        </td>
        <td class="col-2">
          <alto-img-badge [url]="getUser(question.createdBy)?.pictureUrl"></alto-img-badge>
        </td>
        <td *ngIf="question.tags && question.tags.length > 0">
          <alto-colored-pill-list [data]="question.tags" [limit]="3"></alto-colored-pill-list>
        </td>
        <td *ngIf="!question.tags || question.tags.length < 1">-</td>
        <td *ngIf="question.programs && question.programs.length > 0">
          <alto-colored-pill-list [data]="question.programs" [limit]="3"></alto-colored-pill-list>
        </td>
        <td *ngIf="!question.programs || question.programs.length < 1">-</td>
        <td class="pointer pe-auto" (click)="openQuestionForm(question)">
          <i class="fs-5 bi bi-pencil-fill"></i>
        </td>
      </tr>
    </tbody>
  </table>
  <ngb-pagination
    [collectionSize]="questionsCount"
    [(page)]="questionsPage"
    (pageChange)="changeQuestionsPage()"
    [pageSize]="questionsPageSize"
    [maxSize]="10"
    aria-label="Default pagination"
  ></ngb-pagination>
</div>
<div class="py-4 border-bottom">
  <div>
    <h1 id="submittedQuestionsAnchor">{{ I18ns.programs.awaitQuestions.title }}</h1>
    <p class="mb-4">{{ I18ns.programs.awaitQuestions.subtitle }}</p>
  </div>
  <table class="table">
    <thead>
      <tr>
        <th scope="col">{{ I18ns.programs.awaitQuestions.table.question }}</th>
        <th scope="col">{{ I18ns.programs.awaitQuestions.table.author }}</th>
        <th></th>
      </tr>
    </thead>
    <tbody *ngIf="!isSubmittedQuestionsLoading">
      <tr *ngFor="let question of submittedQuestions">
        <th scope="row">{{ question.title }}</th>
        <td>
          <alto-img-badge [url]="getUser(question.createdBy)?.pictureUrl"></alto-img-badge>
        </td>
        <td>
          <i class="fs-5 bi bi-pencil-fill"></i>
        </td>
      </tr>
    </tbody>
  </table>
  <ngb-pagination
    [collectionSize]="submittedQuestionsCount"
    [(page)]="submittedQuestionsPage"
    (pageChange)="changeSubmittedQuestionsPage()"
    [pageSize]="submittedQuestionsPageSize"
    [maxSize]="10"
    aria-label="Default pagination"
  ></ngb-pagination>
</div>
<div class="py-4 border-bottom">
  <button type="button" class="btn btn-primary float-end" (click)="openTagForm()">
    {{ I18ns.programs.tags.createTag }}
  </button>
  <h1 id="tagsAnchor">{{ I18ns.programs.tags.title }}</h1>
  <p class="mb-4">{{ I18ns.programs.tags.subtitle }}</p>
  <div class="col-1 text-end mb-4">
    <alto-dropdown-filter
      class="text-start"
      [data]="programsStore.programs.value"
      [displayLabel]="'name'"
      [placeholder]="I18ns.programs.tags.filters.programs"
      (selectChange)="filterTags($event)"
    ></alto-dropdown-filter>
  </div>
  <table class="table">
    <thead>
      <tr>
        <th scope="col">{{ I18ns.programs.tags.table.name }}</th>
        <th scope="col">{{ I18ns.programs.tags.table.score }}</th>
        <th scope="col">{{ I18ns.programs.tags.table.author }}</th>
        <th scope="col">{{ I18ns.programs.tags.table.associatedPrograms }}</th>
        <th></th>
      </tr>
    </thead>
    <tbody *ngIf="!isTagsLoading">
      <tr *ngFor="let tag of tags">
        <th scope="row">{{ tag.name }}</th>
        <td>
          <span class="badge rounded-pill" [class]="70 | pillColor">42%</span>
        </td>
        <td>
          <alto-img-badge [url]="getUser(tag.createdBy)?.pictureUrl"></alto-img-badge>
        </td>
        <td *ngIf="!isTagProgramsLoading">
          <alto-colored-pill-list [data]="getTagPrograms(tag.id)" [limit]="5"></alto-colored-pill-list>
        </td>
        <td class="pointer pe-auto" (click)="openTagForm(tag)">
          <i class="fs-5 bi bi-pencil-fill"></i>
        </td>
      </tr>
    </tbody>
  </table>
  <ngb-pagination
    [collectionSize]="tagsCount"
    [(page)]="tagsPage"
    (pageChange)="changeTagsPage()"
    [pageSize]="tagsPageSize"
    [maxSize]="10"
    aria-label="Default pagination"
  ></ngb-pagination>
</div>
