<div class="text-end px-4 mt-3">
  <button type="button" class="btn-close" aria-label="Close" (click)="activeOffcanvas.dismiss()"></button>
</div>
<div class="p-4">
  <h2>{{ I18ns.tags.form.title }}</h2>
  <p class="fs-7">{{ I18ns.tags.form.subtitle }}</p>
</div>
<div class="offcanvas-body px-4">
  <form *ngIf="tagForm" [formGroup]="tagForm">
    <label class="form-label required">{{ I18ns.tags.form.tagName }}</label>
    <input
      type="text"
      class="form-control"
      formControlName="name"
      placeholder="{{ I18ns.tags.form.tagNamePlaceholder }}"
    />

    <label class="form-label mt-3">{{ I18ns.tags.form.programs + ' ' + I18ns.tags.form.optional }}</label>
    <ng-select
      [items]="programs"
      [multiple]="true"
      bindLabel="name"
      [placeholder]="I18ns.questions.form.programsPlaceholder"
      [selectableGroup]="true"
      [closeOnSelect]="false"
      bindValue="id"
      formControlName="programs"
    >
      <ng-template ng-label-tmp let-item="item" let-clear="clear">
        <div class="badge rounded-pill p-2" [style.backgroundColor]="item.id | uuid2color">
          <span class="cursor-pointer me-1" (click)="clear(item)" aria-hidden="true">
            <i class="bi bi-x-lg"></i>
          </span>
          <span>{{ item.name }}</span>
        </div>
      </ng-template>
      <ng-template ng-option-tmp let-item="item" let-index="index" let-search="searchTerm">
        <span class="badge rounded-pill p-2" [style.backgroundColor]="item.id | uuid2color">
          {{ item.name }}
        </span>
      </ng-template>
    </ng-select>

    <label class="form-label mt-3">{{ I18ns.tags.form.questions + ' ' + I18ns.tags.form.optional }}</label>
    <ng-select
      [items]="questions"
      [multiple]="true"
      bindLabel="name"
      [placeholder]="I18ns.tags.form.questionsPlaceholder"
      [selectableGroup]="true"
      [closeOnSelect]="false"
      bindValue="id"
      formControlName="questions"
    >
      <ng-template ng-label-tmp let-item="item" let-clear="clear">
        <div class="badge rounded-pill p-2" [style.backgroundColor]="item.id | uuid2color">
          <span class="cursor-pointer me-1" (click)="clear(item)" aria-hidden="true">
            <i class="bi bi-x-lg"></i>
          </span>
          <span>{{ item.title }}</span>
        </div>
      </ng-template>
      <ng-template ng-option-tmp let-item="item" let-index="index" let-search="searchTerm">
        <span class="badge rounded-pill p-2" [style.backgroundColor]="item.id | uuid2color">
          {{ item.title }}
        </span>
      </ng-template>
    </ng-select>

    <label class="form-label mt-3">{{ I18ns.tags.form.description + ' ' + I18ns.tags.form.optional }}</label>
    <textarea formControlName="description" class="form-control" cols="30" rows="10"></textarea>

    <input
    type="submit"
    [disabled]="!tagForm.valid"
    class="w-100 btn btn-primary my-4"
    [value]="I18ns.shared.save"
    (click)="createTag()"
  />
  </form>
</div>
